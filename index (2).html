<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nadine vs The World ü©µ</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #ff4757;
            --secondary: #2ed573;
            --mana: #1e90ff;
            --accent: #ffa502;
        }

        * { box-sizing: border-box; touch-action: manipulation; user-select: none; }
        body { 
            margin: 0; padding: 0; background: #000; 
            font-family: 'Press Start 2P', cursive; color: white;
            overflow: hidden; display: flex; justify-content: center; align-items: center; height: 100vh;
        }

        #game-stage {
            width: 100%; max-width: 420px; height: 100vh;
            background: #111; position: relative; border: 4px solid #333;
            display: flex; flex-direction: column; overflow: hidden;
        }

        .arena {
            flex-grow: 1; position: relative;
            background: linear-gradient(0deg, #1a1a2e 10%, #000 100%);
            display: flex; align-items: flex-end; justify-content: space-around;
            padding-bottom: 50px; border-bottom: 4px solid #444;
        }

        .hud { padding: 15px; display: flex; flex-direction: column; gap: 10px; background: #000; }
        .stat-row { display: flex; justify-content: space-between; align-items: center; }
        .bar-container { width: 140px; }
        .label { font-size: 7px; margin-bottom: 3px; }
        .bar-bg { width: 100%; height: 10px; background: #333; border: 1px solid #fff; }
        .fill { width: 100%; height: 100%; transition: 0.3s; }

        .fighter { font-size: 60px; position: relative; transition: 0.1s; z-index: 10; }
        .idle { animation: idleAnim 1s infinite alternate; }
        @keyframes idleAnim { from { transform: scale(1); } to { transform: scale(1.05); } }
        
        .damaged { animation: shake 0.2s; filter: invert(1); }
        @keyframes shake { 0%, 100% { left: 0; } 25% { left: 10px; } 75% { left: -10px; } }

        .controls {
            display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 15px;
            background: #1a1a1a;
        }
        .btn {
            padding: 15px 5px; border: 3px solid #fff; font-family: 'Press Start 2P';
            font-size: 9px; color: white; cursor: pointer; position: relative;
        }
        .btn:active { transform: scale(0.95); }
        .btn:disabled { opacity: 0.4; filter: grayscale(1); }
        .btn-atk { background: #444; }
        .btn-heal { background: var(--secondary); }
        .btn-ult { background: var(--mana); grid-column: span 2; }
        .stock-tag { position: absolute; top: -5px; right: -5px; background: red; font-size: 6px; padding: 2px; }

        .overlay {
            position: absolute; inset: 0; background: rgba(0,0,0,0.95);
            z-index: 1000; display: flex; flex-direction: column;
            justify-content: center; align-items: center; text-align: center; padding: 20px;
        }
        .hidden { display: none !important; }
        #letter-box {
            background: #000; border: 2px solid var(--primary); padding: 15px;
            font-size: 9px; line-height: 2; text-align: left; overflow-y: auto; max-height: 50vh;
        }
    </style>
</head>
<body>

<div id="game-stage">
    <div class="hud">
        <div class="stat-row">
            <div class="bar-container">
                <div class="label">NADINE IMUT</div>
                <div class="bar-bg"><div id="p-hp" class="fill" style="background:var(--secondary)"></div></div>
            </div>
            <div style="font-size: 10px; color: var(--accent);">VS</div>
            <div class="bar-container">
                <div class="label">EZA JAHAT</div>
                <div class="bar-bg"><div id="e-hp" class="fill" style="background:var(--primary)"></div></div>
            </div>
        </div>
        <div class="stat-row">
            <div class="bar-container">
                <div class="label">MANA (FOR ULT)</div>
                <div class="bar-bg"><div id="p-mana" class="fill" style="background:var(--mana); width: 0%;"></div></div>
            </div>
        </div>
    </div>

    <div class="arena">
        <div id="player" class="fighter idle">üëß</div>
        <div id="enemy" class="fighter idle">üßíüèΩ</div>
    </div>

    <div id="log" style="height: 40px; font-size: 8px; color: #aaa; text-align: center; padding: 10px;">
        nadine iloveuuuu
    </div>

    <div class="controls">
        <button class="btn btn-atk" onclick="act('atk')">PUNCH<br><span style="font-size:6px">+20 MANA</span></button>
        <button id="heal-btn" class="btn btn-heal" onclick="act('heal')">
            HEAL
            <span id="heal-stock" class="stock-tag">3</span>
        </button>
        <button id="ult-btn" class="btn btn-ult" onclick="act('ult')" disabled>
            ULTIMATE LOVE BLAST
        </button>
    </div>

    <div id="start-scr" class="overlay">
        <h1 style="color:var(--primary); font-size: 18px;">NADINE VS FATHAN</h1>
        <p style="font-size: 8px; color: #888;">game ini bertujuan biar kamu bisa memukuli fathan dengan puass</p>
        <button class="btn" style="background:var(--primary); padding: 20px 40px;" onclick="initAudioAndStart()">FIGHT!</button>
    </div>

    <div id="win-scr" class="overlay hidden">
        <h2 style="color:var(--accent)">VICTORY! üíñ</h2>
        <div id="letter-box"><div id="type-area"></div></div>
        <button class="btn" style="margin-top:20px" onclick="location.reload()">PLAY AGAIN</button>
    </div>
</div>

<script>
    // --- AUDIO SYSTEM FIX ---
    let audioCtx = null;

    function initAudioAndStart() {
        // Inisialisasi AudioContext saat klik pertama (syarat Browser)
        if (!audioCtx) {
            audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        }
        if (audioCtx.state === 'suspended') {
            audioCtx.resume();
        }
        document.getElementById('start-scr').classList.add('hidden');
        playSound(440, 'sine', 0.2); // Suara start
    }

    function playSound(freq, type, duration) {
        if (!audioCtx) return;
        
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        
        osc.type = type;
        osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
        
        gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + duration);
        
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        
        osc.start();
        osc.stop(audioCtx.currentTime + duration);
    }

    // --- GAME STATE ---
    const state = {
        pHP: 100, eHP: 150, pMana: 0, healStock: 3,
        turn: true, gameOver: false
    };

    function updateUI() {
        document.getElementById('p-hp').style.width = Math.max(0, state.pHP) + '%';
        document.getElementById('e-hp').style.width = Math.max(0, (state.eHP / 1.5)) + '%';
        document.getElementById('p-mana').style.width = state.pMana + '%';
        document.getElementById('heal-stock').textContent = state.healStock;
        document.getElementById('ult-btn').disabled = state.pMana < 100;
        if(state.healStock <= 0) document.getElementById('heal-btn').disabled = true;
    }

    function act(type) {
        if(!state.turn || state.gameOver) return;
        state.turn = false;
        const log = document.getElementById('log');
        const enemy = document.getElementById('enemy');

        if(type === 'atk') {
            state.eHP -= 15;
            state.pMana = Math.min(100, state.pMana + 20);
            enemy.classList.add('damaged');
            playSound(120, 'square', 0.15); // SFX Pukul
            log.textContent = "SAKIT KAN ZAA (+20 MANA)";
            setTimeout(() => enemy.classList.remove('damaged'), 200);
        } else if(type === 'heal' && state.healStock > 0) {
            state.pHP = Math.min(100, state.pHP + 40);
            state.healStock--;
            playSound(600, 'sine', 0.4); // SFX Heal
            log.textContent = "HEAL DULU GA SIEEE!";
        } else if(type === 'ult' && state.pMana >= 100) {
            state.eHP -= 70;
            state.pMana = 0;
            enemy.classList.add('damaged');
            playSound(800, 'sawtooth', 0.6); // SFX Ultimate
            log.textContent = "MAMPUSSS LU ZAAAAAA!!!";
            setTimeout(() => enemy.classList.remove('damaged'), 500);
        }

        updateUI();
        if(state.eHP <= 0) return win();
        setTimeout(enemyTurn, 800);
    }

    function enemyTurn() {
        if(state.gameOver) return;
        const log = document.getElementById('log');
        const player = document.getElementById('player');
        
        const isCrit = Math.random() > 0.7;
        const dmg = isCrit ? 28 : 15;
        state.pHP -= dmg;
        
        player.classList.add('damaged');
        playSound(80, 'sawtooth', 0.2); // SFX Musuh Mukul
        log.style.color = isCrit ? 'red' : 'white';
        log.textContent = isCrit ? "NOOOOO" : "EZA BALESS";
        
        updateUI();
        setTimeout(() => player.classList.remove('damaged'), 200);

        if(state.pHP <= 0) {
            state.gameOver = true;
            log.textContent = "NADINE LOST.. COBA LAGI YUKK.";
            setTimeout(() => location.reload(), 2000);
        } else {
            state.turn = true;
        }
    }

    function win() {
        state.gameOver = true;
        document.getElementById('win-scr').classList.remove('hidden');
        playSound(500, 'sine', 0.2);
        setTimeout(() => playSound(700, 'sine', 0.5), 200);
        
        const msg = `HAII NADINEE SAYANGG ü©µ\n\nwihh menang yaa main game inii.. game ini tu bertujuan buat kamu biar bisa ngantemi fathann terusss wkkwkw, jadii kamu bisa deh ngantem fathan se puas puasnya di game iniii.. maaf yak kalau jelek soalnya buatnya jam tiga pagi ini heheheee\n\nmakasihh yaa sayangg kemarinn bener bener sudah maafin fathannn, ak seneng bangett kita bisa balik lagi seperti biasanyaaa, bahkan bisa ngobrol panjaangg bangett di alfamart saat sekolahh, aku seneng banget dehh bisa di beri kesempatan lagii.. aku gaakan sia siain kesempatan itu deh pokoknyaaa, ak harus bertanggung jawab atas semua yang aku lakukan.. btw congratss atas nilai TKAnyaa yaaaa, aku banggaa banget sama kamuu sayangg.. aku bener bener banggaa karena bisa lihat perjuangan kamu selama masa masa TKA ituu, aku memaksa kamu buat belajarr sampe kamunnya marah marahh, teruss bisa sampe tengah malemm, laluu belajar di perpuss, sebulan full belajarr dll dehhh.. pokoonyaa banggaa bangett lihatt hasilmu yang se memuaskan ituu. sekali lagi congratss yaa cantikk\n\nyasudaa wkekwkek ini ak buatnya se pagi ituuz bukan karena apa apaa karena ini sebenernya sebelum ketiduran kemarinn udaa ak buat tapi belum ku lanuutinnn jadinyaa aga gimana gitu kalau ga lanjutt.. yasudaa goodmorningg yaa sayanggg, semangatt buat hari inii yaaa.. pulang gasik nihh kamu bisa main jadinyaaa, dann hari ini kamu pasti cantik bangett aselii, ga sabar aku melihatnyaa hehehee.. okeyydee selamat bersktivitass yaaaa, dann terimakasih atas segalanya yakk.. AKU SUMPAHIN KAMU LOLOS SNBP UNDIP, DAN AKU SUMPAHIN KAMU JADI ORANG SUKSES YANG BISA BANTU BANYAK ORANG SAYANGGGG... GOODLUCK FOR TODAAYY YAAAAA JE T'AIMEEEE BIEENN MON AMOURRR  üíôü©µüíôü©µüíôü©µüíôü©µüíô`;
        
        let i = 0;
        function type() {
            if(i < msg.length) {
                document.getElementById('type-area').innerHTML += msg[i] === '\n' ? '<br>' : msg[i];
                i++; setTimeout(type, 50);
            }
        }
        type();
    }
</script>
</body>
</html>
